<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>视频自动剪辑工具 - 项目介绍</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .section {
            margin-bottom: 40px;
            padding: 20px;
            border-radius: 8px;
            background-color: #f9f9f9;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .section-title {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #4CAF50;
        }
        
        .subsection-title {
            font-size: 20px;
            font-weight: bold;
            color: #555;
            margin: 20px 0 15px 0;
        }
        
        .code-block {
            background-color: #f5f5f5;
            border-left: 4px solid #4CAF50;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
        }
        
        .api-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        .api-table th, .api-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        
        .api-table th {
            background-color: #4CAF50;
            color: white;
        }
        
        .api-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        
        ul, ol {
            margin: 10px 0;
            padding-left: 20px;
        }
        
        li {
            margin: 8px 0;
        }
        
        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: #4CAF50;
            text-decoration: none;
            font-weight: bold;
        }
        
        .back-link:hover {
            text-decoration: underline;
        }
        
        .mermaid {
            text-align: center;
            margin: 20px 0;
        }
        
        .user-section {
            background-color: #e8f5e9;
        }
        
        .developer-section {
            background-color: #e3f2fd;
        }
        
        .feature-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .feature-card h4 {
            margin-top: 0;
            color: #2e7d32;
        }
        
        .tech-stack {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        
        .tech-item {
            background: #4CAF50;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .diagram-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        
        .architecture-diagram {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            margin: 20px 0;
        }
        
        .arch-component {
            flex: 1;
            min-width: 150px;
            text-align: center;
            padding: 15px;
            background: #f5f5f5;
            border-radius: 8px;
            border: 1px solid #ddd;
        }
        
        .arch-component h4 {
            margin: 0 0 10px 0;
            color: #333;
        }
        
        .arrow {
            font-size: 24px;
            color: #4CAF50;
        }
    </style>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true });
    </script>
</head>
<body>
    <div class="container">
        <a href="{{ url_for('index') }}" class="back-link">← 返回主页面</a>
        
        <h1>视频自动剪辑工具 - 项目介绍</h1>
        
        <!-- 面向泛人群的部分 -->
        <div class="section user-section">
            <h2 class="section-title">🎯 这是什么工具？</h2>
            <p>视频自动剪辑工具是一个基于Web的多媒体处理应用，旨在简化视频编辑流程，提高内容创作者的工作效率。无论你是教育工作者、自媒体创作者还是普通用户，都可以通过这个工具快速完成视频剪辑任务。</p>
            
            <h3 class="subsection-title">🌟 核心功能</h3>
            <div class="feature-card">
                <h4>✂️ 视频剪辑</h4>
                <p>上传原始视频和剪辑需求，自动裁剪出你需要的视频片段</p>
            </div>
            
            <div class="feature-card">
                <h4>🔗 视频拼接</h4>
                <p>将多个视频片段按顺序拼接成一个完整的视频</p>
            </div>
            
            <div class="feature-card">
                <h4>📊 信息分析</h4>
                <p>自动提取视频基本信息，帮助你更好地了解视频内容</p>
            </div>
            
            <h3 class="subsection-title">🚀 使用流程</h3>
            <div class="diagram-container">
                <div class="mermaid">
graph TD
    A[上传视频] --> B[设置剪辑点]
    B --> C[执行剪辑]
    C --> D[下载结果]
    D --> E[完成]
                </div>
            </div>
            
            <h3 class="subsection-title">👥 适用人群</h3>
            <ul>
                <li><strong>教育工作者</strong>: 快速剪辑课程视频，提取重点内容</li>
                <li><strong>自媒体创作者</strong>: 高效处理大量视频素材</li>
                <li><strong>普通用户</strong>: 简单易用的视频编辑工具</li>
            </ul>
        </div>
        
        <!-- 面向开发者的部分 -->
        <div class="section developer-section">
            <h2 class="section-title">💻 技术架构与开发指南</h2>
            
            <h3 class="subsection-title">🏗️ 系统架构</h3>
            <div class="architecture-diagram">
                <div class="arch-component">
                    <h4>前端界面</h4>
                    <p>HTML/CSS/JavaScript</p>
                </div>
                <div class="arrow">→</div>
                <div class="arch-component">
                    <h4>Web服务</h4>
                    <p>Flask</p>
                </div>
                <div class="arrow">→</div>
                <div class="arch-component">
                    <h4>处理引擎</h4>
                    <p>FFmpeg/MoviePy</p>
                </div>
            </div>
            
            <h3 class="subsection-title">🔧 技术栈</h3>
            <div class="tech-stack">
                <div class="tech-item">Python Flask</div>
                <div class="tech-item">FFmpeg</div>
                <div class="tech-item">MoviePy</div>
                <div class="tech-item">HTML5/CSS3</div>
                <div class="tech-item">JavaScript</div>
                <div class="tech-item">Pandas</div>
            </div>
            
            <h3 class="subsection-title">📋 核心处理流程</h3>
            <div class="diagram-container">
                <div class="mermaid">
graph TD
    A[用户请求] --> B{功能类型}
    B -->|视频剪辑| C[smart_cut函数]
    B -->|视频拼接| D[concatenate_videos函数]
    C --> E[零重编码处理]
    E -->|成功| F[返回结果]
    E -->|失败| G[MoviePy回退]
    G --> F
    D --> H[FFmpeg拼接]
    H -->|成功| F
    H -->|失败| I[MoviePy回退]
    I --> F
                </div>
            </div>
            
            <h3 class="subsection-title">📚 核心函数</h3>
            
            <h4>1. 视频剪辑相关函数</h4>
            <div class="code-block">
// 零重编码精准切片
def smart_cut(in_file, out_file, start, end):
    """使用FFmpeg进行零重编码切片"""
    cmd = [
        FFMPEG_PATH,
        '-i', in_file,
        '-ss', str(start),
        '-to', str(end),
        '-c', 'copy',  # 零重编码
        '-y',
        out_file
    ]
                
// 根据DataFrame裁剪视频
def cut_videos_from_dataframe(input_video_path, df):
    """根据Excel数据裁剪视频片段"""
    # 遍历数据帧中的每一行进行裁剪
</div>
            
            <h4>2. 视频拼接相关函数</h4>
            <div class="code-block">
// 零重编码拼接
def concatenate_videos(video_paths, output_path):
    """使用FFmpeg进行零重编码拼接"""
    # 生成concat清单文件
    # 调用FFmpeg命令拼接视频
                
// 回退拼接方案
def fallback_concatenate_videos(video_paths, output_path):
    """使用MoviePy进行拼接（回退方案）"""
    # 使用MoviePy的concatenate_videoclips函数
</div>
            
            <h4>3. 工具函数</h4>
            <div class="code-block">
// 时间转换函数
def time_to_seconds(t):
    """将时间字符串转换为秒数"""
                
def seconds_to_time(seconds):
    """将秒数转换为时间字符串"""
                
// 视频信息提取
def get_video_info(video_path):
    """获取视频基本信息"""
</div>
            
            <h3 class="subsection-title">📡 API接口</h3>
            
            <table class="api-table">
                <thead>
                    <tr>
                        <th>接口路径</th>
                        <th>方法</th>
                        <th>功能描述</th>
                        <th>请求参数</th>
                        <th>返回值</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>/upload_video</code></td>
                        <td>POST</td>
                        <td>上传视频文件</td>
                        <td>视频文件</td>
                        <td>上传结果和文件路径</td>
                    </tr>
                    <tr>
                        <td><code>/upload_excel</code></td>
                        <td>POST</td>
                        <td>上传Excel文件</td>
                        <td>Excel文件</td>
                        <td>文件内容和路径</td>
                    </tr>
                    <tr>
                        <td><code>/get_video_info</code></td>
                        <td>POST</td>
                        <td>获取视频信息</td>
                        <td>视频文件路径</td>
                        <td>视频基本信息</td>
                    </tr>
                    <tr>
                        <td><code>/cut_videos</code></td>
                        <td>POST</td>
                        <td>执行视频剪辑</td>
                        <td>视频路径和剪辑数据</td>
                        <td>剪辑结果</td>
                    </tr>
                    <tr>
                        <td><code>/concat_videos</code></td>
                        <td>POST</td>
                        <td>执行视频拼接</td>
                        <td>视频路径列表</td>
                        <td>拼接结果</td>
                    </tr>
                    <tr>
                        <td><code>/export_excel</code></td>
                        <td>POST</td>
                        <td>导出剪辑需求Excel</td>
                        <td>表格数据</td>
                        <td>Excel文件信息</td>
                    </tr>
                    <tr>
                        <td><code>/list_output_files</code></td>
                        <td>GET</td>
                        <td>列出输出文件</td>
                        <td>无</td>
                        <td>文件列表</td>
                    </tr>
                    <tr>
                        <td><code>/download/&lt;filename&gt;</code></td>
                        <td>GET</td>
                        <td>下载文件</td>
                        <td>文件名</td>
                        <td>文件内容</td>
                    </tr>
                </tbody>
            </table>
            
            <h3 class="subsection-title">🛡️ 容错机制</h3>
            <div class="diagram-container">
                <div class="mermaid">
graph TD
    A[视频处理请求] --> B[FFmpeg零重编码]
    B -->|成功| C[完成处理]
    B -->|失败| D[MoviePy重新编码]
    D -->|成功| C
    D -->|失败| E[返回错误信息]
                </div>
            </div>
            
            <h3 class="subsection-title">📦 项目结构</h3>
            <div class="code-block">
video_cutter_project/
├── app.py              # 主应用文件
├── requirements.txt    # 依赖包列表
├── static/
│   ├── css/
│   │   └── style.css   # 样式文件
│   └── js/
│       └── script.js   # JavaScript逻辑
├── templates/
│   ├── index.html      # 主页面
│   └── about.html      # 关于页面
└── README.md           # 项目说明
            </div>
            
            <h3 class="subsection-title">🚀 部署指南</h3>
            <ol>
                <li>安装依赖: <code>pip install -r requirements.txt</code></li>
                <li>确保FFmpeg已安装并配置到环境变量</li>
                <li>运行应用: <code>python app.py</code></li>
                <li>访问 <code>http://localhost:5001</code></li>
            </ol>
        </div>
    </div>
</body>
</html>