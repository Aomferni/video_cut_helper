<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è§†é¢‘è‡ªåŠ¨å‰ªè¾‘å·¥å…· - é¡¹ç›®ä»‹ç»</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .section {
            margin-bottom: 40px;
            padding: 20px;
            border-radius: 8px;
            background-color: #f9f9f9;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .section-title {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #4CAF50;
        }
        
        .subsection-title {
            font-size: 20px;
            font-weight: bold;
            color: #555;
            margin: 20px 0 15px 0;
        }
        
        .code-block {
            background-color: #f5f5f5;
            border-left: 4px solid #4CAF50;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .code-header {
            font-weight: bold;
            color: #2e7d32;
            margin-bottom: 8px;
            font-size: 16px;
        }
        
        .code-content {
            background-color: #fff;
            padding: 10px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            white-space: pre;
        }
        
        .project-structure {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 20px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .project-structure-header {
            font-weight: bold;
            color: #2e7d32;
            margin-bottom: 15px;
            font-size: 18px;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 8px;
        }
        
        .project-structure-content {
            background-color: #fff;
            padding: 15px;
            border-radius: 4px;
            white-space: pre;
            overflow-x: auto;
            line-height: 1.5;
        }
        
        .api-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        .api-table th, .api-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        
        .api-table th {
            background-color: #4CAF50;
            color: white;
        }
        
        .api-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        
        ul, ol {
            margin: 10px 0;
            padding-left: 20px;
        }
        
        li {
            margin: 8px 0;
        }
        
        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: #4CAF50;
            text-decoration: none;
            font-weight: bold;
        }
        
        .back-link:hover {
            text-decoration: underline;
        }
        
        .mermaid {
            text-align: center;
            margin: 20px 0;
        }
        
        .user-section {
            background-color: #e8f5e9;
        }
        
        .developer-section {
            background-color: #e3f2fd;
        }
        
        .feature-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .feature-card h4 {
            margin-top: 0;
            color: #2e7d32;
        }
        
        .tech-stack {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        
        .tech-item {
            background: #4CAF50;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .diagram-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        
        .architecture-diagram {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            margin: 20px 0;
        }
        
        .arch-component {
            flex: 1;
            min-width: 150px;
            text-align: center;
            padding: 15px;
            background: #f5f5f5;
            border-radius: 8px;
            border: 1px solid #ddd;
        }
        
        .arch-component h4 {
            margin: 0 0 10px 0;
            color: #333;
        }
        
        .arrow {
            font-size: 24px;
            color: #4CAF50;
        }
    </style>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true });
    </script>
</head>
<body>
    <div class="container">
        <a href="{{ url_for('index') }}" class="back-link">â† è¿”å›ä¸»é¡µé¢</a>
        
        <h1>è§†é¢‘è‡ªåŠ¨å‰ªè¾‘å·¥å…· - é¡¹ç›®ä»‹ç»</h1>
        
        <!-- é¢å‘æ³›äººç¾¤çš„éƒ¨åˆ† -->
        <div class="section user-section">
            <h2 class="section-title">ğŸ¯ è¿™æ˜¯ä»€ä¹ˆå·¥å…·ï¼Ÿ</h2>
            <p>è§†é¢‘è‡ªåŠ¨å‰ªè¾‘å·¥å…·æ˜¯ä¸€ä¸ªåŸºäºWebçš„å¤šåª’ä½“å¤„ç†åº”ç”¨ï¼Œæ—¨åœ¨ç®€åŒ–è§†é¢‘ç¼–è¾‘æµç¨‹ï¼Œæé«˜å†…å®¹åˆ›ä½œè€…çš„å·¥ä½œæ•ˆç‡ã€‚æ— è®ºä½ æ˜¯æ•™è‚²å·¥ä½œè€…ã€è‡ªåª’ä½“åˆ›ä½œè€…è¿˜æ˜¯æ™®é€šç”¨æˆ·ï¼Œéƒ½å¯ä»¥é€šè¿‡è¿™ä¸ªå·¥å…·å¿«é€Ÿå®Œæˆè§†é¢‘å‰ªè¾‘ä»»åŠ¡ã€‚</p>
            
            <h3 class="subsection-title">ğŸŒŸ æ ¸å¿ƒåŠŸèƒ½</h3>
            <div class="feature-card">
                <h4>âœ‚ï¸ è§†é¢‘å‰ªè¾‘</h4>
                <p>ä¸Šä¼ åŸå§‹è§†é¢‘å’Œå‰ªè¾‘éœ€æ±‚ï¼Œè‡ªåŠ¨è£å‰ªå‡ºä½ éœ€è¦çš„è§†é¢‘ç‰‡æ®µ</p>
            </div>
            
            <div class="feature-card">
                <h4>ğŸ”— è§†é¢‘æ‹¼æ¥</h4>
                <p>å°†å¤šä¸ªè§†é¢‘ç‰‡æ®µæŒ‰é¡ºåºæ‹¼æ¥æˆä¸€ä¸ªå®Œæ•´çš„è§†é¢‘</p>
            </div>
            
            <div class="feature-card">
                <h4>ğŸ“Š è§†é¢‘æ‰“æ ‡</h4>
                <p>æ’­æ”¾è§†é¢‘ï¼Œå¸®ä½ æ›´ä¾¿æ·åœ°è®°å½•è§†é¢‘åˆ†æ®µä¿¡æ¯</p>
            </div>
            
            <h3 class="subsection-title">ğŸš€ ä½¿ç”¨æµç¨‹</h3>
            <div class="diagram-container">
                <div class="mermaid">
graph TD
    A[ä¸Šä¼ è§†é¢‘] --> B[è®¾ç½®å‰ªè¾‘ç‚¹]
    B --> C[æ‰§è¡Œå‰ªè¾‘]
    C --> D[ä¸‹è½½ç»“æœ]
    D --> E[å®Œæˆ]
                </div>
            </div>
            
            <h3 class="subsection-title">ğŸ‘¥ é€‚ç”¨äººç¾¤</h3>
            <ul>
                <li><strong>æ•™è‚²å·¥ä½œè€…</strong>: å¿«é€Ÿå‰ªè¾‘è¯¾ç¨‹è§†é¢‘ï¼Œæå–é‡ç‚¹å†…å®¹</li>
                <li><strong>è‡ªåª’ä½“åˆ›ä½œè€…</strong>: é«˜æ•ˆå¤„ç†å¤§é‡è§†é¢‘ç´ æ</li>
                <li><strong>æ™®é€šç”¨æˆ·</strong>: ç®€å•æ˜“ç”¨çš„è§†é¢‘ç¼–è¾‘å·¥å…·</li>
            </ul>
        </div>
        
        <!-- é¢å‘å¼€å‘è€…çš„éƒ¨åˆ† -->
        <div class="section developer-section">
            <h2 class="section-title">ğŸ’» æŠ€æœ¯æ¶æ„ä¸å¼€å‘æŒ‡å—</h2>
            
            <h3 class="subsection-title">ğŸ—ï¸ ç³»ç»Ÿæ¶æ„</h3>
            <div class="architecture-diagram">
                <div class="arch-component">
                    <h4>å‰ç«¯ç•Œé¢</h4>
                    <p>HTML/CSS/JavaScript</p>
                </div>
                <div class="arrow">â†’</div>
                <div class="arch-component">
                    <h4>WebæœåŠ¡</h4>
                    <p>Flask</p>
                </div>
                <div class="arrow">â†’</div>
                <div class="arch-component">
                    <h4>å¤„ç†å¼•æ“</h4>
                    <p>FFmpeg/MoviePy</p>
                </div>
            </div>
            
            <h3 class="subsection-title">ğŸ”§ æŠ€æœ¯æ ˆ</h3>
            <div class="tech-stack">
                <div class="tech-item">Python Flask</div>
                <div class="tech-item">FFmpeg</div>
                <div class="tech-item">MoviePy</div>
                <div class="tech-item">HTML5/CSS3</div>
                <div class="tech-item">JavaScript</div>
                <div class="tech-item">Pandas</div>
            </div>
            
            <h3 class="subsection-title">ğŸ“‹ æ ¸å¿ƒå¤„ç†æµç¨‹</h3>
            <div class="diagram-container">
                <div class="mermaid">
graph TD
    A[ç”¨æˆ·è¯·æ±‚] --> B{åŠŸèƒ½ç±»å‹}
    B -->|è§†é¢‘å‰ªè¾‘| C[smart_cutå‡½æ•°]
    B -->|è§†é¢‘æ‹¼æ¥| D[concatenate_videoså‡½æ•°]
    C --> E[é›¶é‡ç¼–ç å¤„ç†]
    E -->|æˆåŠŸ| F[è¿”å›ç»“æœ]
    E -->|å¤±è´¥| G[MoviePyå›é€€]
    G --> F
    D --> H[FFmpegæ‹¼æ¥]
    H -->|æˆåŠŸ| F
    H -->|å¤±è´¥| I[MoviePyå›é€€]
    I --> F
                </div>
            </div>
            
            <h3 class="subsection-title">ğŸ“š æ ¸å¿ƒå‡½æ•°é€»è¾‘</h3>
            
            <div class="feature-card">
                <h4>1. è§†é¢‘å‰ªè¾‘å‡½æ•° - smart_cut</h4>
                <p><strong>åŠŸèƒ½ï¼š</strong>ä½¿ç”¨FFmpegè¿›è¡Œé›¶é‡ç¼–ç ç²¾å‡†åˆ‡ç‰‡ï¼Œé€Ÿåº¦æå¿«ä¸”ä¿æŒåŸå§‹è´¨é‡</p>
                <div class="code-block">
                        <div class="code-header">ä¼ªä»£ç é€»è¾‘:</div>
                        <div class="code-content">
function smart_cut(input_file, output_file, start_time, end_time):
    æ„å»ºFFmpegå‘½ä»¤ = [
        FFMPEG_PATH,
        '-i', input_file,     // è¾“å…¥æ–‡ä»¶
        '-ss', start_time,    // å¼€å§‹æ—¶é—´
        '-to', end_time,      // ç»“æŸæ—¶é—´
        '-c', 'copy',         // é›¶é‡ç¼–ç 
        '-y', output_file     // è¾“å‡ºæ–‡ä»¶
    ]
    æ‰§è¡Œå‘½ä»¤()
    è¿”å›ç»“æœ
                        </div>
                    </div>
                </div>
                
                <div class="feature-card">
                    <h4>2. æ‰¹é‡å‰ªè¾‘å‡½æ•° - cut_videos_from_dataframe</h4>
                    <p><strong>åŠŸèƒ½ï¼š</strong>æ ¹æ®Excelæ•°æ®æ‰¹é‡è£å‰ªè§†é¢‘ç‰‡æ®µ</p>
                    <div class="code-block">
                        <div class="code-header">ä¼ªä»£ç é€»è¾‘:</div>
                        <div class="code-content">
function cut_videos_from_dataframe(video_path, excel_data):
    for æ¯ä¸€è¡Œ in excel_data:
        if ç»“æŸæ—¶é—´ä¸ºç©º:
            continue  // è·³è¿‡ç©ºè¡Œ
    
        å¼€å§‹æ—¶é—´ = è¡Œæ•°æ®["å¼€å§‹æ—¶é—´"]
        ç»“æŸæ—¶é—´ = è¡Œæ•°æ®["ç»“æŸæ—¶é—´"]
        æ ‡é¢˜ = è¡Œæ•°æ®["å‰ªè¾‘æ ‡é¢˜"]
    
        // è½¬æ¢æ—¶é—´æ ¼å¼
        start_seconds = time_to_seconds(å¼€å§‹æ—¶é—´)
        end_seconds = time_to_seconds(ç»“æŸæ—¶é—´)
    
        // æ‰§è¡Œå‰ªè¾‘
        smart_cut(video_path, è¾“å‡ºè·¯å¾„, start_seconds, end_seconds)
                        </div>
                    </div>
                </div>
                
                <div class="feature-card">
                    <h4>3. è§†é¢‘æ‹¼æ¥å‡½æ•° - concatenate_videos</h4>
                    <p><strong>åŠŸèƒ½ï¼š</strong>ä½¿ç”¨FFmpegé›¶é‡ç¼–ç æ‹¼æ¥å¤šä¸ªè§†é¢‘æ–‡ä»¶</p>
                    <div class="code-block">
                        <div class="code-header">ä¼ªä»£ç é€»è¾‘:</div>
                        <div class="code-content">
function concatenate_videos(video_list, output_path):
    // ç”Ÿæˆæ¸…å•æ–‡ä»¶
    åˆ›å»ºæ¸…å•æ–‡ä»¶()
    for è§†é¢‘ in video_list:
        å†™å…¥æ¸…å•æ–‡ä»¶(è§†é¢‘è·¯å¾„)
    
    // æ„å»ºFFmpegå‘½ä»¤
    å‘½ä»¤ = [
        FFMPEG_PATH,
        '-f', 'concat',
        '-safe', '0',
        '-i', æ¸…å•æ–‡ä»¶,
        '-c', 'copy',
        '-y', output_path
    ]
    
    ç»“æœ = æ‰§è¡Œå‘½ä»¤(å‘½ä»¤)
    if ç»“æœ.æˆåŠŸ:
        return æˆåŠŸä¿¡æ¯
    else:
        return å›é€€æ–¹æ¡ˆ()  // MoviePyæ‹¼æ¥
                        </div>
                    </div>
                </div>
                
                <div class="feature-card">
                    <h4>4. å·¥å…·å‡½æ•°</h4>
                    <p><strong>åŠŸèƒ½ï¼š</strong>è¾…åŠ©å¤„ç†å‡½æ•°</p>
                    <div class="code-block">
                        <div class="code-header">æ—¶é—´è½¬æ¢å‡½æ•°:</div>
                        <div class="code-content">
function time_to_seconds(time_string):
    // å°† "HH:MM:SS" è½¬æ¢ä¸ºç§’æ•°
    parts = åˆ†å‰²æ—¶é—´å­—ç¬¦ä¸²(time_string, ":")
    hours = è½¬æ¢ä¸ºæ•°å­—(parts[0])
    minutes = è½¬æ¢ä¸ºæ•°å­—(parts[1])
    seconds = è½¬æ¢ä¸ºæ•°å­—(parts[2])
    return hours * 3600 + minutes * 60 + seconds
                        </div>
                    </div>
                    <div class="code-block">
                        <div class="code-header">è§†é¢‘ä¿¡æ¯æå–:</div>
                        <div class="code-content">
function get_video_info(video_path):
    // ä½¿ç”¨MoviePyè·å–è§†é¢‘ä¿¡æ¯
    è§†é¢‘ = VideoFileClip(video_path)
    æ—¶é•¿ = è§†é¢‘.duration
    å¸§ç‡ = è§†é¢‘.fps
    åˆ†è¾¨ç‡ = è§†é¢‘.size
    return {æ—¶é•¿, å¸§ç‡, åˆ†è¾¨ç‡}
                        </div>
                    </div>
                </div>
            
            <h3 class="subsection-title">ğŸ“¡ APIæ¥å£</h3>
            
            <table class="api-table">
                <thead>
                    <tr>
                        <th>æ¥å£è·¯å¾„</th>
                        <th>æ–¹æ³•</th>
                        <th>åŠŸèƒ½æè¿°</th>
                        <th>è¯·æ±‚å‚æ•°</th>
                        <th>è¿”å›å€¼</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>/upload_video</code></td>
                        <td>POST</td>
                        <td>ä¸Šä¼ è§†é¢‘æ–‡ä»¶</td>
                        <td>è§†é¢‘æ–‡ä»¶</td>
                        <td>ä¸Šä¼ ç»“æœå’Œæ–‡ä»¶è·¯å¾„</td>
                    </tr>
                    <tr>
                        <td><code>/upload_excel</code></td>
                        <td>POST</td>
                        <td>ä¸Šä¼ Excelæ–‡ä»¶</td>
                        <td>Excelæ–‡ä»¶</td>
                        <td>æ–‡ä»¶å†…å®¹å’Œè·¯å¾„</td>
                    </tr>
                    <tr>
                        <td><code>/get_video_info</code></td>
                        <td>POST</td>
                        <td>è·å–è§†é¢‘ä¿¡æ¯</td>
                        <td>è§†é¢‘æ–‡ä»¶è·¯å¾„</td>
                        <td>è§†é¢‘åŸºæœ¬ä¿¡æ¯</td>
                    </tr>
                    <tr>
                        <td><code>/cut_videos</code></td>
                        <td>POST</td>
                        <td>æ‰§è¡Œè§†é¢‘å‰ªè¾‘</td>
                        <td>è§†é¢‘è·¯å¾„å’Œå‰ªè¾‘æ•°æ®</td>
                        <td>å‰ªè¾‘ç»“æœ</td>
                    </tr>
                    <tr>
                        <td><code>/concat_videos</code></td>
                        <td>POST</td>
                        <td>æ‰§è¡Œè§†é¢‘æ‹¼æ¥</td>
                        <td>è§†é¢‘è·¯å¾„åˆ—è¡¨</td>
                        <td>æ‹¼æ¥ç»“æœ</td>
                    </tr>
                    <tr>
                        <td><code>/export_excel</code></td>
                        <td>POST</td>
                        <td>å¯¼å‡ºå‰ªè¾‘éœ€æ±‚Excel</td>
                        <td>è¡¨æ ¼æ•°æ®</td>
                        <td>Excelæ–‡ä»¶ä¿¡æ¯</td>
                    </tr>
                    <tr>
                        <td><code>/list_output_files</code></td>
                        <td>GET</td>
                        <td>åˆ—å‡ºè¾“å‡ºæ–‡ä»¶</td>
                        <td>æ— </td>
                        <td>æ–‡ä»¶åˆ—è¡¨</td>
                    </tr>
                    <tr>
                        <td><code>/download/&lt;filename&gt;</code></td>
                        <td>GET</td>
                        <td>ä¸‹è½½æ–‡ä»¶</td>
                        <td>æ–‡ä»¶å</td>
                        <td>æ–‡ä»¶å†…å®¹</td>
                    </tr>
                </tbody>
            </table>
            
            <h3 class="subsection-title">ğŸ›¡ï¸ å®¹é”™æœºåˆ¶</h3>
            <div class="diagram-container">
                <div class="mermaid">
graph TD
    A[è§†é¢‘å¤„ç†è¯·æ±‚] --> B[FFmpegé›¶é‡ç¼–ç ]
    B -->|æˆåŠŸ| C[å®Œæˆå¤„ç†]
    B -->|å¤±è´¥| D[MoviePyé‡æ–°ç¼–ç ]
    D -->|æˆåŠŸ| C
    D -->|å¤±è´¥| E[è¿”å›é”™è¯¯ä¿¡æ¯]
                </div>
            </div>
            
            <h3 class="subsection-title">ğŸ“¦ é¡¹ç›®ç»“æ„</h3>
            <div class="project-structure">
                <div class="project-structure-header">é¡¹ç›®ç›®å½•ç»“æ„</div>
                <div class="project-structure-content">
video_cutter_project/
â”œâ”€â”€ app.py              # ä¸»åº”ç”¨æ–‡ä»¶
â”œâ”€â”€ requirements.txt    # ä¾èµ–åŒ…åˆ—è¡¨
â”œâ”€â”€ static/
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ style.css   # æ ·å¼æ–‡ä»¶
â”‚   â””â”€â”€ js/
â”‚       â””â”€â”€ script.js   # JavaScripté€»è¾‘
â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ index.html      # ä¸»é¡µé¢
â”‚   â””â”€â”€ about.html      # å…³äºé¡µé¢
â””â”€â”€ README.md           # é¡¹ç›®è¯´æ˜
                </div>
            </div>
            
            <h3 class="subsection-title">ğŸš€ éƒ¨ç½²æŒ‡å—</h3>
            <ol>
                <li>å®‰è£…ä¾èµ–: <code>pip install -r requirements.txt</code></li>
                <li>ç¡®ä¿FFmpegå·²å®‰è£…å¹¶é…ç½®åˆ°ç¯å¢ƒå˜é‡</li>
                <li>è¿è¡Œåº”ç”¨: <code>python app.py</code></li>
                <li>è®¿é—® <code>http://localhost:5001</code></li>
            </ol>
        </div>
    </div>
</body>
</html>